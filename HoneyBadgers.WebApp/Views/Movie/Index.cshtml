@model List<HoneyBadgers.Logic.Models.MovieViewModel>
@using HoneyBadgers.Logic.Enums

@{
    ViewData["Title"] = "Movies";
}

<form class="d-flex my-3">
    <select id="filter-type" class="hb-movie-select form-select-lg" name="FilterType" asp-items="Html.GetEnumSelectList<SortType>()"></select>
</form>
<div class="d-flex my-3">
    <input type="number" class="form-control" id="ratingFrom" />
    <input type="number" class="form-control" id="ratingTo"/>
    <button id="SearchByRating">Search</button>
</div>
<div id="movies-list">
    <partial name="../Shared/_MoviePartialView.cshtml" model="@Model" />
</div>

@section Scripts{
    <script>
        var filterValue, ratingFrom, ratingTo;
        $(function () {
            $("#filter-type").change(function () {
                filterValue = $(this).val();
                $.ajax({
                    type: "Get",
                    url: "/Movie/ShowMovies?sortType=" + filterValue + "&ratingFrom=" + ratingFrom + "&ratingTo=" + ratingTo,
                    success: function (data) {
                        $("#movies-list").html("");
                        $("#movies-list").html(data);
                    },
                    error: function (response) {
                        console.log(response.responseText);
                    }
                });
            });
            $("#SearchByRating").click(function () {
                ratingFrom = $("#ratingFrom").val();
                ratingTo = $("#ratingTo").val();
                $.ajax({
                    type: "Get",
                    url: "/Movie/ShowMovies?sortType=" + filterValue + "&ratingFrom=" + ratingFrom + "&ratingTo=" + ratingTo,
                    success: function (data) {
                        $("#movies-list").html("");
                        $("#movies-list").html(data);
                    },
                    error: function (response) {
                        console.log(response.responseText);
                    }
                });
            });
        });
    </script>
}